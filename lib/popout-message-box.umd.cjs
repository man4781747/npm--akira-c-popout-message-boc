(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.PopoutMwessageBox={},a.Vue))})(this,function(a,n){"use strict";const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function w(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}let c;const T=new Uint8Array(16);function D(){if(!c){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");c=crypto.getRandomValues.bind(crypto)}return c(T)}const h={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function I(e,t,o){var l;if(h.randomUUID&&!e)return h.randomUUID();e=e||{};const i=e.random??((l=e.rng)==null?void 0:l.call(e))??D();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,w(i)}const S=Symbol("PopoutMessage");let p=null;function b(){if(!p)throw new Error("Root App 尚未初始化，請確認已使用 app.use(PopoutMessagePlugin)");return p}const y={install:e=>{e.provide(S,d),p=e}},E=n.ref(0);function M(){let e=document.getElementById("popout-message-box-list");return e||(e=document.createElement("div"),e.id="popout-message-box-list",document.body.appendChild(e)),e}const u=(e,t,o,i=5)=>{const l=M(),g=I(),r=document.createElement("div");r.id=g,r.className="popout-message-box";const f=n.createVNode(m,{eleID:g,messageType:e,mainString:t,despString:o||"",lifeTime:i});f.appContext=b()._context,n.render(f,r),l.appendChild(r),l.prepend(r)},d={success:(e,t,o)=>u("success",e,t,o),error:(e,t,o)=>u("fail",e,t,o),info:(e,t,o)=>u("info",e,t,o),warning:(e,t,o)=>u("warning",e,t,o),debug:(e,t,o)=>u("debug",e,t,o),primary:(e,t,o)=>u("primary",e,t,o),status:{count:E}},P=n.defineComponent({name:"PopoutMessageBox",props:{messageType:{type:String,required:!0},eleID:{type:String,required:!0},lifeTime:{type:Number,default:5},mainString:{type:String,required:!0},despString:{type:String,default:""}},data(){return{create:!1,delItem:null,startTime:-1,remaining:-1}},computed:{isAnimeStop(){return this.delItem===null}},mounted(){this.create=!0,setTimeout(()=>{this.getEleHeight()},100),this.remaining=this.lifeTime*1e3,this.startTime=Date.now(),this.delItem=window.setTimeout(()=>{this.delThisWindow()},this.remaining)},methods:{getEleHeight(){const e=document.getElementById(this.eleID);return!e||!e.children[0]?0:(e.children[0].style.height=`${e.offsetHeight}px`,e.offsetHeight)},delThisWindow(){this.stopDel();const e=document.getElementById(this.eleID);!e||!e.children[0]||(e.children[0].style.height="0px",this.create=!1,d.status.count.value>0&&(d.status.count.value-=1),setTimeout(()=>{e.remove()},2e3))},stopDel(){this.delItem!==null&&(clearTimeout(this.delItem),this.delItem=null,this.remaining-=Date.now()-this.startTime)},resumeDel(){this.startTime=Date.now(),this.delItem=window.setTimeout(()=>{this.delThisWindow()},this.remaining)}},created(){d.status.count.value+=1,console.log(d.status.count.value)},deactivated(){d.status.count.value>0&&(d.status.count.value-=1)}}),B=(e,t)=>{const o=e.__vccOpts||e;for(const[i,l]of t)o[i]=l;return o},U={class:"card-body"},x={class:"card-title"},C={class:"card-desp"};function V(e,t,o,i,l,g){return n.openBlock(),n.createBlock(n.Transition,{name:"when-create"},{default:n.withCtx(()=>[e.create?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(["card",e.messageType]),onMouseenter:t[0]||(t[0]=(...r)=>e.stopDel&&e.stopDel(...r)),onMouseleave:t[1]||(t[1]=(...r)=>e.resumeDel&&e.resumeDel(...r)),onClick:t[2]||(t[2]=(...r)=>e.delThisWindow&&e.delThisWindow(...r))},[n.createVNode(n.Transition,{name:"when-create"},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(["time-mask",e.isAnimeStop?"stop":""]),style:n.normalizeStyle(`animation: time_mask_anime ${e.lifeTime}s linear forwards;`)},null,6)]),_:1}),n.createElementVNode("div",U,[n.createElementVNode("div",x,n.toDisplayString(e.mainString),1),n.createElementVNode("div",C,n.toDisplayString(e.despString),1)])],34)):n.createCommentVNode("",!0)]),_:1})}const m=B(P,[["render",V]]),k=[m],N={install:e=>{k.forEach(t=>{e.component("PopoutMessageBox",m)}),e.use(y)}};a.PopoutMessageBox=m,a.PopoutMessagePlugin=y,a.default=N,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
