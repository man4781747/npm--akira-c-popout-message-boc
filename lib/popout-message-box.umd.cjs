(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.PopoutMwessageBox={},a.Vue))})(this,function(a,n){"use strict";const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function D(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}let m;const I=new Uint8Array(16);function M(){if(!m){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");m=crypto.getRandomValues.bind(crypto)}return m(I)}const h={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function P(e,t,o){var d;if(h.randomUUID&&!e)return h.randomUUID();e=e||{};const i=e.random??((d=e.rng)==null?void 0:d.call(e))??M();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,D(i)}const y=Symbol("PopoutMessage");let p=null;function S(){if(!p)throw new Error("Root App 尚未初始化，請確認已使用 app.use(PopoutMessagePlugin)");return p}const f={install:e=>{e.provide(y,l),p=e}};function w(){const e=n.inject(y);if(!e)throw new Error("PopoutMessage service not provided via PopoutMessagePlugin.");return e}const E=n.ref(0);function b(){let e=document.getElementById("popout-message-box-list");return e||(e=document.createElement("div"),e.id="popout-message-box-list",document.body.appendChild(e)),e}const u=(e,t,o,i=5)=>{const d=b(),g=P(),r=document.createElement("div");r.id=g,r.className="popout-message-box";const T=n.createVNode(c,{eleID:g,messageType:e,mainString:t,despString:o||"",lifeTime:i});T.appContext=S()._context,n.render(T,r),d.appendChild(r),d.prepend(r)},l={success:(e,t,o)=>u("success",e,t,o),error:(e,t,o)=>u("fail",e,t,o),info:(e,t,o)=>u("info",e,t,o),warning:(e,t,o)=>u("warning",e,t,o),debug:(e,t,o)=>u("debug",e,t,o),primary:(e,t,o)=>u("primary",e,t,o),status:{count:E}},B=n.defineComponent({name:"PopoutMessageBox",props:{messageType:{type:String,required:!0},eleID:{type:String,required:!0},lifeTime:{type:Number,default:5},mainString:{type:String,required:!0},despString:{type:String,default:""}},data(){return{create:!1,delItem:null,startTime:-1,remaining:-1}},computed:{isAnimeStop(){return this.delItem===null}},mounted(){this.create=!0,setTimeout(()=>{this.getEleHeight()},100),this.remaining=this.lifeTime*1e3,this.startTime=Date.now(),this.delItem=window.setTimeout(()=>{this.delThisWindow()},this.remaining)},methods:{getEleHeight(){const e=document.getElementById(this.eleID);return!e||!e.children[0]?0:(e.children[0].style.height=`${e.offsetHeight}px`,e.offsetHeight)},delThisWindow(){this.stopDel();const e=document.getElementById(this.eleID);!e||!e.children[0]||(e.children[0].style.height="0px",this.create=!1,l.status.count.value>0&&(l.status.count.value-=1),setTimeout(()=>{e.remove()},2e3))},stopDel(){this.delItem!==null&&(clearTimeout(this.delItem),this.delItem=null,this.remaining-=Date.now()-this.startTime)},resumeDel(){this.startTime=Date.now(),this.delItem=window.setTimeout(()=>{this.delThisWindow()},this.remaining)}},created(){l.status.count.value+=1,console.log(l.status.count.value)},deactivated(){l.status.count.value>0&&(l.status.count.value-=1)}}),U=(e,t)=>{const o=e.__vccOpts||e;for(const[i,d]of t)o[i]=d;return o},C={class:"card-body"},V={class:"card-title"},x={class:"card-desp"};function k(e,t,o,i,d,g){return n.openBlock(),n.createBlock(n.Transition,{name:"when-create"},{default:n.withCtx(()=>[e.create?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(["card",e.messageType]),onMouseenter:t[0]||(t[0]=(...r)=>e.stopDel&&e.stopDel(...r)),onMouseleave:t[1]||(t[1]=(...r)=>e.resumeDel&&e.resumeDel(...r)),onClick:t[2]||(t[2]=(...r)=>e.delThisWindow&&e.delThisWindow(...r))},[n.createVNode(n.Transition,{name:"when-create"},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(["time-mask",e.isAnimeStop?"stop":""]),style:n.normalizeStyle(`animation: time_mask_anime ${e.lifeTime}s linear forwards;`)},null,6)]),_:1}),n.createElementVNode("div",C,[n.createElementVNode("div",V,n.toDisplayString(e.mainString),1),n.createElementVNode("div",x,n.toDisplayString(e.despString),1)])],34)):n.createCommentVNode("",!0)]),_:1})}const c=U(B,[["render",k]]),N=[c],v={install:e=>{N.forEach(t=>{e.component("PopoutMessageBox",c)}),e.use(f)},usePopoutMessage:w};a.PopoutMessageBox=c,a.PopoutMessagePlugin=f,a.default=v,a.usePopoutMessage=w,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
